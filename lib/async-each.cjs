function e(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=/*#__PURE__*/e(require("@chriscdn/promise-semaphore"));module.exports=function(e,n,t,o){var u;void 0===t&&(t=function(){}),void 0===o&&(o={});var i=0,c=e.length,l=null!=(u=o.rateLimit)?u:0,a=l?new r.default(l):null,s=e.map(function(e,r,o){return new Promise(function(u,l){try{return setTimeout(function(){try{var s=function(s,f){try{var h=function(l,s){try{var f=Promise.resolve(null==a?void 0:a.acquire()).then(function(){return Promise.resolve(n(e,r,o)).then(function(n){u(n),t({progress:i++,total:c,percent:Math.floor(100*i/c),item:e,index:r,result:n})})})}catch(e){return s(e)}return f&&f.then?f.then(void 0,s):f}(0,function(e){l(e)})}catch(e){return f(!0,e)}return h&&h.then?h.then(f.bind(null,!1),f.bind(null,!0)):f(!1,h)}(0,function(e,r){if(null==a||a.release(),e)throw r;return r});return Promise.resolve(s&&s.then?s.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},1),Promise.resolve()}catch(e){return Promise.reject(e)}})});return Promise.all(s)};
//# sourceMappingURL=async-each.cjs.map
