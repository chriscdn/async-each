import{Semaphore as r}from"@chriscdn/promise-semaphore";var e=function(e,n,t,o){var i;void 0===t&&(t=function(){}),void 0===o&&(o={});var u=0,c=e.length,l=null!=(i=o.rateLimit)?i:0,s=l>0?new r(l):null,a=e.map(function(r,e,o){return new Promise(function(i,l){try{return setTimeout(function(){try{var a=function(a,h){try{var f=function(l,a){try{var h=Promise.resolve(null==s?void 0:s.acquire()).then(function(){return Promise.resolve(n(r,e,o)).then(function(n){i(n),t({progress:u++,total:c,percent:Math.floor(100*u/c),item:r,index:e,result:n})})})}catch(r){return a(r)}return h&&h.then?h.then(void 0,a):h}(0,function(r){l(r)})}catch(r){return h(!0,r)}return f&&f.then?f.then(h.bind(null,!1),h.bind(null,!0)):h(!1,f)}(0,function(r,e){if(null==s||s.release(),r)throw e;return e});return Promise.resolve(a&&a.then?a.then(function(){}):void 0)}catch(r){return Promise.reject(r)}},0),Promise.resolve()}catch(r){return Promise.reject(r)}})});return Promise.all(a)};export{e as default};
//# sourceMappingURL=async-each.module.js.map
