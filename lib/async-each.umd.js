!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("@chriscdn/promise-semaphore")):"function"==typeof define&&define.amd?define(["@chriscdn/promise-semaphore"],n):(e||self).asyncEach=n(e.Semaphore)}(this,function(e){function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var t=/*#__PURE__*/n(e);return function(e,n,r,o){var i;void 0===r&&(r=function(){}),void 0===o&&(o={});var u=0,c=e.length,l=null!=(i=o.rateLimit)?i:0,f=l?new t.default(l):null,s=e.map(function(e,t,o){return new Promise(function(i,l){try{return setTimeout(function(){try{var s=function(s,a){try{var h=function(l,s){try{var a=Promise.resolve(null==f?void 0:f.acquire()).then(function(){return Promise.resolve(n(e,t,o)).then(function(n){i(n),r({progress:u++,total:c,percent:Math.floor(100*u/c),item:e,index:t,result:n})})})}catch(e){return s(e)}return a&&a.then?a.then(void 0,s):a}(0,function(e){l(e)})}catch(e){return a(!0,e)}return h&&h.then?h.then(a.bind(null,!1),a.bind(null,!0)):a(!1,h)}(0,function(e,n){if(null==f||f.release(),e)throw n;return n});return Promise.resolve(s&&s.then?s.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},1),Promise.resolve()}catch(e){return Promise.reject(e)}})});return Promise.all(s)}});
//# sourceMappingURL=async-each.umd.js.map
